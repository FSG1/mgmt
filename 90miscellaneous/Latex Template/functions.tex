\newcommand{\grey}[0]{\cellcolor[HTML]{9B9B9B}}
\newcommand{\cell}[1]{#1}
\newcommand{\multicell}[2]{\multicolumn{#1}{l|}{#2}}
\newcommand{\greyCell}[1]{\grey{}\cell{\textbf{#1}}}
\newcommand{\nospace}[0]{\vspace{-1.8em}}

\newcolumntype{Y}{>{\centering\arraybackslash}X}


\renewcommand{\arraystretch}{1.5}
\addtolength{\oddsidemargin}{-.6in}
\addtolength{\evensidemargin}{-.6in}
\addtolength{\textwidth}{1.2in}

\addtolength{\topmargin}{-.5in}
\addtolength{\textheight}{1.2in}

\newenvironment{header}[0]{
	\newcommand{\PrintModule}[0]{}
	\newcommand{\Module}[1]{
		\renewcommand{\PrintModule}[0]{\greyCell{Module} & \multicolumn{5}{l|}{##1} \\ \hline}
	}

	\newcommand{\PrintAuthors}[0]{}
	\newcommand{\Authors}[1]{
		\renewcommand{\PrintAuthors}[0]{\greyCell{Authors} & \multicolumn{5}{l|}{##1} \\ \hline}
	}

	\newcommand{\PrintCredentials}[0]{}
	\newcommand{\Credentials}[1]{
		\renewcommand{\PrintCredentials}[0]{\greyCell{Credentials} & \multicolumn{5}{l|}{##1} \\ \hline}
	}
	
	\newcommand{\PrintInfo}[0]{}
	\newcommand{\SemesterValue}[0]{}
	\newcommand{\CreditsValue}[0]{}
	\newcommand{\ValidOfValue}[0]{}
	\newcommand{\DeclareInfoRow}[0]{
		\renewcommand{\PrintInfo}[0]{\greyCell{Semester} & \SemesterValue & \greyCell{Credits (ECTS)} & \CreditsValue & \greyCell{Valid as of} & \ValidOfValue \\ \hline}
	}
	\newcommand{\Semester}[1]{
		\DeclareInfoRow
		\renewcommand{\SemesterValue}[0]{##1}
	}
	\newcommand{\Credits}[1]{
		\DeclareInfoRow
		\renewcommand{\CreditsValue}[0]{##1}
	}
	\newcommand{\ValidOf}[1]{
		\DeclareInfoRow
		\renewcommand{\ValidOfValue}[0]{##1}
	}

	\newcommand{\PrintHours}[0]{}
	\newcommand{\LecturesValue}[0]{}
	\newcommand{\PracticalValue}[0]{}
	\newcommand{\TotalEffortValue}[0]{}
	\newcommand{\DeclareHoursRow}[0]{
		\renewcommand{\PrintHours}[0]{
			\greyCell{Lectures / week} & \LecturesValue & \greyCell{Practical Hours / week} & \PracticalValue & \greyCell{Total Effort} & \TotalEffortValue hours \\ \hline
		}
	}
	\newcommand{\Lectures}[1]{
		\DeclareHoursRow
		\renewcommand{\LecturesValue}[0]{##1}
	}
	\newcommand{\Practical}[1]{
		\DeclareHoursRow
		\renewcommand{\PracticalValue}[0]{##1}
	}
	\newcommand{\TotalEffort}[1]{
		\DeclareHoursRow
		\renewcommand{\TotalEffortValue}[0]{##1}
	}
}{
	\begin{table}[H]
		\begin{tabularx}{\textwidth}{|l|Y|l|Y|l|l|}
			\hline
			\PrintModule
			\PrintInfo
			\PrintHours
			\PrintAuthors
			\PrintCredentials
		\end{tabularx}
	\end{table}
	\nospace
}

\newcommand{\Introduction}[1]{
	\begin{table}[H]
		\begin{tabularx}{\textwidth}{|X|}
			\hline
			\greyCell{Introduction and Motivation} \\ \hline
			#1 \\ \hline
		\end{tabularx}
	\end{table}
	\nospace
}

\newenvironment{learninggoals}[0]{
	\newcommand{\LearningGoal}[2]{
		##1 & ##2 \\ \hline
	}
	\newcommand{\GroupGoals}[0]{
		\multicolumn{2}{|l|}{\greyCell{Learning Goals: The group is able to ...}} \\ \hline
	}

	\table[H]
		\tabularx{\textwidth}{|c|X|}
		\hline
		\multicolumn{2}{|l|}{\greyCell{Learning Goals: The student is able to ...}} \\ \hline
}{
		\endtabularx
	\endtable
	\nospace
}

\newenvironment{topics}[0]{
	\newcommand{\Topic}[1]{
		\item ##1
	}
	\table[H]
		\tabularx{\textwidth}{|X|}
			\hline
			\greyCell{Topics} \\ \hline
			\itemize[noitemsep,topsep=0pt]
}{		
		\enditemize  \\ \hline
		\endtabularx
	\endtable
	\nospace
}

\newenvironment{teachingmaterial}[0]{
	\newcommand{\Material}[1]{
		\item ##1
	}
	\table[H]
	\tabularx{\textwidth}{|X|}
	\hline
	\greyCell{Teaching Material} \\ \hline
	\itemize[noitemsep,topsep=0pt]
}{		
	\enditemize \\ \hline
	\endtabularx
	\endtable
	\nospace
}

\newcommand{\AdditionalInformation}[1]{
	\begin{table}[H]
		\begin{tabularx}{\textwidth}{|X|}
			\hline
			\greyCell{Additional Information} \\ \hline
			#1 \\ \hline
		\end{tabularx}
	\end{table}
	\nospace
}